<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>&lt;web-components&gt;</title>
    <script type="module" src="assets/highlight.js"></script>
    <script type="module" src="src/presentable-show.js"></script>
    <link rel="stylesheet" type="text/css" href="src/index.css" />
    <link rel="stylesheet" type="text/css" href="assets/tomorrow-night-eighties.css" />
    <link rel="stylesheet" type="text/css" href="src/slides.css" />
    <script type="module">
      hljs.initHighlightingOnLoad();
    </script>
  </head>
  <body>
    <pres-show>
      <pres-slide id="title">
        <h1><code>&lt;web-components&gt;</code></h1>
        <pres-cue slot="cues">Showtime!</pres-cue>
      </pres-slide>

      <pres-slide id="definition">
        <h2>Web Component<br />(<em>wɛb kəmˈpəʊnənt</em>)<br />noun</h2>
        <p>A collection of technologies used to create reusable HTML elements with encapsulated functionality.</p>
        <pres-cue slot="cues">What are web components?</pres-cue>
        <ul>
          <li>HTML Templates</li>
          <li>Custom Elements</li>
          <li>Shadow DOM</li>
        </ul>
        <pres-cue slot="cues" step>HTML Templates</pres-cue>
        <pres-cue slot="cues" step>Custom Elements</pres-cue>
        <pres-cue slot="cues" step>Shadow DOM</pres-cue>
      </pres-slide>

      <pres-slide id="exposed">
        <p class="warning">
          Web Components aim to expose internal DOM APIs and behaviour to developers, not
          <strong class="underline">fix</strong> or re-imagine the way the DOM currently works!
        </p>
        <pres-cue slot="cues">Internal APIs exposed</pres-cue>
      </pres-slide>

      <pres-slide id="html-templates">
        <header>
          <h2>HTML Templates</h2>
          <p>
            Two new HTML elements for describing unrendered, <strong class="underline">static</strong> markup that may
            be efficiently reused multiple times:
          </p>
        </header>
        <ul>
          <li><code>&lt;template&gt;</code> HTML Content Template element</li>
          <li><code>&lt;slot&gt;</code> HTML Slot element</li>
        </ul>
        <pres-cue slot="cues"></pres-cue>
        <pres-cue slot="cues" step
          >&lt;template&gt; parsed but not rendered until contents are cloned and inserted into DOM</pres-cue
        >
        <pres-cue slot="cues" step
          >&lt;slot&gt; placeholder inside web component for accepting user markup into a Shadow DOM</pres-cue
        >
      </pres-slide>

      <pres-slide id="ht-template">
        <h3><code>&lt;template&gt;</code></h3>
        <pre class="code"><code class="html">
          &lt;template id="tmpl"&gt;
            &lt;h1&gt;Some title&lt;/h1&gt;
            &lt;p&gt;Some body text...&lt;/p&gt;
          &lt;/template&gt;
        </code></pre>
        <pre class="code"><code class="js">
          const tmpl = document.querySelector('#tmpl');
          // Clone the template content to reuse it multiple times
          document.body.appendChild(tmpl.content.cloneNode(true));
        </code></pre>
        <pre class="code"><code class="html">
          &lt;!-- template instantiation proposal --&gt;
          &lt;template id="tmpl"&gt;
            &lt;h1&gt;{{ title }}&lt;/h1&gt;
            &lt;p&gt;{{ body }}&lt;/p&gt;
          &lt;/template&gt;
        </code></pre>
        <pres-cue slot="cues" step>template tag</pres-cue>
        <pres-cue slot="cues" step>clone contents</pres-cue>
        <pres-cue slot="cues" step>template Instantiation lit-html</pres-cue>
      </pres-slide>

      <pres-slide id="ht-slot">
        <h3><code>&lt;slot&gt;</code></h3>
        <pre class="code"><code class="html">
          &lt;template id="tmpl"&gt;
            &lt;h1&gt;Some title&lt;/h1&gt;
            &lt;!-- placeholder with fallback content --&gt;
            &lt;slot&gt;Waiting for body text...&lt;/slot&gt;
          &lt;/template&gt;
        </code></pre>
        <pre class="code"><code class="js">
          const tmpl = document.querySelector('#tmpl');
          // Clone the template content to use in a custom element's Shadow DOM
          this.attachShadow({ mode: 'open' }).appendChild(tmpl.content.cloneNode(true));
        </code></pre>
        <pres-cue slot="cues" step></pres-cue>
        <pres-cue slot="cues" step></pres-cue>
      </pres-slide>

      <pres-slide id="custom-elements">
        <header>
          <h2>Custom Elements</h2>
          <p>APIs for creating HTML elements with custom behaviour.</p>
        </header>
        <p><code>&lt;my-element&gt;&lt;/my-element&gt;</code></p>
        <pres-cue slot="cues"></pres-cue>
      </pres-slide>

      <pres-slide id="ce-step1">
        <header>
          <h3>Custom Elements #1</h3>
          <p>
            Extend <em><code>HTMLElement</code></em>
          </p>
        </header>
        <pre class="code"><code class="js">
          class MyComponent extends HTMLElement {
            constructor() {
              super();
              this.innerHTML = '&lt;h1&gt;Some title&lt;/h1&gt;&lt;p&gt;Some body text...&lt;/p&gt;'
            }
          }
        </code></pre>
        <pres-cue slot="cues"></pres-cue>
      </pres-slide>

      <pres-slide id="ce-step2">
        <header>
          <h3>Custom Elements #2</h3>
          <p>Register tag name</p>
        </header>
        <pre class="code"><code class="js">
          window.customElements.define('my-component', MyComponent);
        </code></pre>
        <div class="warnings">
          <p class="warning">
            Tag names must contain at least one '<strong><code>-</code></strong
            >' character
          </p>
          <p class="warning">
            A tag name and <code>Constructor</code> can only be registered <strong class="underline">once</strong>
          </p>
        </div>
        <pres-cue slot="cues"></pres-cue>
        <pres-cue slot="cues" step></pres-cue>
        <pres-cue slot="cues" step></pres-cue>
      </pres-slide>

      <pres-slide id="ce-step3">
        <header>
          <h3>Custom Elements #3</h3>
          <p>Add element to DOM</p>
        </header>
        <pre class="code"><code class="html">
          &lt;html&gt;
            &lt;body&gt;
              &lt;!-- server-rendered markup --&gt;
              &lt;my-component fancy&gt;&lt;/my-component&gt;
            &lt;/body&gt;
          &lt;/html&gt;
        </code></pre>
        <pres-cue slot="cues" step></pres-cue>
        <pre class="code"><code class="js">
          const myComponent = document.createElement('my-component');
          myComponent.setAttribute('fancy', '');
          document.body.appendChild(myComponent);
        </code></pre>
        <pres-cue slot="cues" step></pres-cue>
        <pre class="code"><code class="js">
          document.body.innerHTML = '&lt;my-component fancy&gt;&lt;/my-component&gt;';
        </code></pre>
        <pres-cue slot="cues" step></pres-cue>
      </pres-slide>

      <pres-slide id="ce-lifecycle">
        <header>
          <h3>Custom Elements</h3>
          <p>Element Lifecycle</p>
        </header>
        <pre class="code"><code class="js">
          class MyComponent extends HTMLElement {
            <span class="highlight one">constructor()</span> {
              super(); // required!
              this.fancy = false;
              // inspection of attributes or children not allowed!
            }
            <span class="highlight two">connectedCallback()</span> {
              this.fancy = this.getAttribute('fancy') !== null;
              this.addEventListener('click', this, false);
            }
            <span class="highlight three">disconnectedCallback()</span> {
              this.removeEventListener('click', this, false);
            }
          }
        </code></pre>
        <pres-cue slot="cues"></pres-cue>
        <pres-cue slot="cues" step>highlight</pres-cue>
        <pres-cue slot="cues" step>highlight</pres-cue>
        <pres-cue slot="cues" step>highlight</pres-cue>
      </pres-slide>

      <pres-slide id="ce-upgrade">
        <header>
          <h3>Custom Elements</h3>
          <p>Element upgrade</p>
        </header>
        <p>
          Custom elements are <strong class="underline">upgraded</strong> from <em>unknown</em> when parsed before
          behaviour has been defined.
        </p>
        <pre class="code"><code class="css">
          my-component:not(:defined) {
            display: none;
          }
        </code></pre>
        <pres-cue slot="cues"></pres-cue>
        <pres-cue slot="cues" step>css :defined</pres-cue>
      </pres-slide>

      <pres-slide id="ce-ready">
        <header>
          <h3>Custom Elements</h3>
          <p>Ready or not?</p>
        </header>
        <p>When is it <em>safe</em> to inspect own attributes and children?</p>
        <pres-cue slot="cues"></pres-cue>
        <table>
          <thead>
            <tr>
              <th colspan="2">Rendering in sloooow motion...</th>
            </tr>
            <tr>
              <th>Markup</th>
              <th>DOM</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>
                <code>&lt;my-element</code>
              </td>
              <td>
                <code>&lt;my-element&gt;&lt;/my-element&gt;</code>
              </td>
            </tr>
            <tr>
              <td>
                <code>&lt;my-element some="attr"</code>
              </td>
              <td>
                <code>&lt;my-element some="attr"&gt;&lt;/my-element&gt;</code>
              </td>
            </tr>
            <tr>
              <td>
                <code>&lt;my-element some="attr"&gt;&lt;h2&gt;Hi!</code>
              </td>
              <td>
                <code>&lt;my-element some="attr"&gt;&lt;h2&gt;Hi!&lt;/h2&gt;&lt;/my-element&gt;</code>
              </td>
            </tr>
            <tr>
              <td>
                <code>&lt;my-element some="attr"&gt;&lt;h2&gt;Hi!&lt;/h2&gt;&lt;/my-element&gt;</code>
              </td>
              <td>
                <code>&lt;my-element some="attr"&gt;&lt;h2&gt;Hi!&lt;/h2&gt;&lt;/my-element&gt;</code>
              </td>
            </tr>
          </tbody>
        </table>
        <pres-cue slot="cues" step></pres-cue>
        <pre class="code"><code class="js">
          import { ReadyMixin } from '@nrk/element-ready-mixin';

          class MyComponent extends ReadyMixin(HTMLElement) {
            readyCallback() {
              // Fully parsed
            }
          }
        </code></pre>
        <pres-cue slot="cues" step></pres-cue>
      </pres-slide>

      <pres-slide id="ce-reactivity">
        <header>
          <h3>Custom Elements</h3>
          <p>Element State reactivity</p>
        </header>
        <pre class="code"><code class="js compact">
          class MyComponent extends HTMLElement {
            <span class="highlight one">static get observedAttributes()</span> { return ['active']; }
            <span class="highlight two">attributeChangedCallback(name, oldValue, newValue)</span> {
              this.updated(name, oldValue);
            }
            get active() { return this.hasAttribute('active'); }
            set active(value) {
              value ? this.setAttribute('active', '') : this.removeAttribute('active');
            }
            constructor() {
              super();
              <span class="highlight three">this._fancy = false;</span>
            }
            get fancy() { return this._fancy; }
            <span class="highlight four">set fancy(value)</span> {
              const oldValue = this._fancy;
              this._fancy = value;
              this.updated('fancy', oldValue);
            }
            <span class="highlight five">updated(propName, oldValue)</span> {
              console.log(`property ${propName} updated from ${oldValue} to ${this[propName]}`);
            }
          }
        </code></pre>
        <pres-cue slot="cues"></pres-cue>
        <pres-cue slot="cues" step>observe</pres-cue>
        <pres-cue slot="cues" step>observe</pres-cue>
        <pres-cue slot="cues" step>reflect</pres-cue>
        <pres-cue slot="cues" step>reflect</pres-cue>
        <pres-cue slot="cues" step>update</pres-cue>
      </pres-slide>

      <pres-slide id="ce-base">
        <header>
          <h3>Custom Elements</h3>
          <p>Reactive base classes</p>
        </header>
        <pre class="code"><code class="js compact">
          import { LiElement } from 'lit-element';
          class MyComponent extends LitElement {
            static get properties() {
              return {
                active: { type: Boolean, reflect: false },
                fancy: { type: Boolean, reflect: false }
              }
            }
            constructor() {
              super();
              this.active = false;
              this.fancy = false;
            }
          }
        </code></pre>
        <pres-cue slot="cues" step>LitElement</pres-cue>
        <pre class="code"><code class="js compact">
          import { ReactiveElement } from '@nrk/reactive-element';
          class MyComponent extends ReactiveElement {
            static get reactiveProperties() {
              return {
                attributes: { active: Boolean },
                properties: { fancy: Boolean }
              }
            }
            constructor() {
              super();
              this.active = false;
              this.fancy = false;
            }
          }
        </code></pre>
        <pres-cue slot="cues" step>ReactiveElement</pres-cue>
      </pres-slide>

      <pres-slide id="ce-built-ins">
        <header>
          <h3>Custom Elements</h3>
          <p>Extending built-ins</h3>
        </header>
        <pre class="code"><code class="js">
          class MyButton extends HTMLButtonElement {}

          window.customElements.define('my-button', MyButton, { extends: 'button' })
        </code></pre>
        <pre class="code"><code class="html">
          &lt;button is=&quot;my-button&quot;&gt;&lt;/button&gt;
        </code></pre>
        <pres-cue slot="cues">autonomous vs customized built-ins</pres-cue>
        <p class="nope">❌</p>
        <pres-cue slot="cues" step>Safari says no!</pres-cue>
      </pres-slide>

      <pres-slide id="shadow-dom">
        <header>
          <h2>Shadow<br/>DOM</h2>
          <p>A hidden DOM tree and scoped styles for your custom-elements.</p>
        </header>
        <p><strong><code>&lt;video&gt;&lt;/video&gt;</code></strong></p>
        <pres-cue slot="cues">encapsulation: video tag</pres-cue>
      </pres-slide>

      <pres-slide id="sd-init">
        <header>
          <h3>Shadow<br/>DOM</h3>
          <p>Initialisation</p>
        </header>
        <pre class="code"><code class="js">
          const template = document.createElement('template');
          template.innerHTML = '&lt;h2 id="title"&gt;My Component&lt;/h2&gt;';

          class MyComponent extends HTMLElement {
            constructor() {
              super();
              <span class="highlight">this.attachShadow({ mode: 'open' })</span>.appendChild(template.content.cloneNode(true));
            }
          }
        </code></pre>
        <pres-cue slot="cues"></pres-cue>
        <pres-cue slot="cues" step>attachShadow mode: open vs closed</pres-cue>
      </pres-slide>

      <pres-slide id="sd-styling">
        <header>
          <h3>Shadow<br/>DOM</h3>
          <p>Styling</p>
        </header>
        <pre class="code"><code class="js">
          const template = document.createElement('template');
          template.innerHTML = `
            &lt;style&gt;
              <span class="highlight one">:host</span> {
                <span class="highlight two">display: block;</span>
              }
              <span class="highlight three">:host([active])</span> {
                color: chartreuse;
              }
              <span class="highlight four">:host-context(.dark)</span> {
                color: antiquewhite;
              }
              <span class="highlight five">#title</span> {
                font-size: 24px;
              }
            &lt;/style&gt;
            &lt;h2 id="title"&gt;My Component&lt;/h2&gt;
          `;

          class MyComponent extends HTMLElement {
            constructor() {
              super();
              this.attachShadow({ mode: 'open' }).appendChild(template.content.cloneNode(true));
            }
          }
        </code></pre>
        <pres-cue slot="cues">inline style tag for scoping (and perf)</pres-cue>
        <pres-cue slot="cues">link tag also scoped</pres-cue>
        <pres-cue slot="cues" step>:host</pres-cue>
        <pres-cue slot="cues" step>display: inline default</pres-cue>
        <pres-cue slot="cues">specificity: outside styles win</pres-cue>
        <pres-cue slot="cues" step>:host(selector)</pres-cue>
        <pres-cue slot="cues" step>:host-context(selector)</pres-cue>
        <pres-cue slot="cues" step>id scoping</pres-cue>
      </pres-slide>

      <pres-slide id="sd-slots">
        <header>
          <h3>Shadow<br/>DOM</h3>
          <p>Slotting user content</p>
        </header>
        <pre class="code"><code class="js">
          const template = document.createElement('template');
          template.innerHTML = `
            &lt;h2 id="title"&gt;My Component&lt;/h2&gt;
            <span class="highlight one">&lt;slot&gt;Default content&lt;/slot&gt;</span>
            &lt;ul&gt;<span class="highlight two">&lt;slot name=&quot;items&quot;&gt;&lt;/slot&gt;</span>&lt;/ul&gt;
          `;

          class MyComponent extends HTMLElement {
            constructor() {
              super();
              this.attachShadow({ mode: 'open' }).appendChild(template.content.cloneNode(true));
            }
          }
        </code></pre>
        <div class="side-by-side">
          <pre class="code"><code class="html">
            &lt;my-component&gt;
              &lt;p&gt;Some body content&lt;/p&gt;
              &lt;li slot=&quot;items&quot;&gt;one&lt;/li&gt;
              &lt;li slot=&quot;items&quot;&gt;&lt;em&gt;two&lt;/em&gt;&lt;/li&gt;
            &lt;/my-component&gt;
          </code></pre>
          <pre class="code"><code class="html">
            &lt;my-component&gt;
              &lt;h2 id="title"&gt;My Component&lt;/h2&gt;
              &lt;p&gt;Some body content&lt;/p&gt;
              &lt;ul&gt;
                &lt;li slot=&quot;items&quot;&gt;one&lt;/li&gt;
                &lt;li slot=&quot;items&quot;&gt;two&lt;/li&gt;
              &lt;/ul&gt;
            &lt;/my-component&gt;
          </code></pre>
        </div>
        <pres-cue slot="cues">top level children only</pres-cue>
        <pres-cue slot="cues" step>define slots in template: default (with fallback content), and named (also collections)</pres-cue>
        <pres-cue slot="cues" step>default (with fallback content)</pres-cue>
        <pres-cue slot="cues" step>named (also collections)</pres-cue>
        <pres-cue slot="cues" step>user defined content</pres-cue>
        <pres-cue slot="cues" step>projected and flattened</pres-cue>
      </pres-slide>

      <pres-slide id="sd-slots-styling">
        <header>
          <h3>Shadow<br/>DOM</h3>
          <p>Styling slotted content</p>
        </header>
        <p>Slot content is <em>distributed</em> into the Shadow DOM, not copied, so styles applied before distribution still apply:</p>
        <pre class="code"><code class="css">
          my-component li {
            color: papayawhip;
          }
        </code></pre>
        <pre class="code"><code class="css">
          /* Select all slotted content */
          ::slotted(*) {
            color: hotpink;
          }
          /* Select specific type of slotted content */
          ::slotted(li) {
            display: inline-block;
            padding: 1em;
          }
          /* Won't work! Only top level styling allowed */
          ::slotted(li em) {
            color: chartreuse;
          }
        </code></pre>
        <pres-cue slot="cues" step>Slots distributed, not moved, so styles applied before distribution still apply!</pres-cue>
        <pres-cue slot="cues" step>Can specify styling from within a component with ::slotted()</pres-cue>
        <pres-cue slot="cues">but only top-level</pres-cue>
      </pres-slide>

      <pres-slide id="sd-slots-api">
        <header>
          <h3>Shadow<br/>DOM</h3>
          <p>Slots JavaScript API</p>
        </header>
        <pre class="code"><code class="js">
          class MyComponent extends HTMLElement {
            constructor() {
              super();
              this.attachShadow({ mode: 'open' }).appendChild(template.content.cloneNode(true));
              this.shadowRoot.querySelector('slot')?.addEventListener(
                'slotchange',
                (event) => {
                  for (const slottedChild of event.target.assignedElements()) {
                    // Do something with slotted child
                  }
                },
                { once: true }
              );
            }
          }
        </code></pre>
        <pres-cue slot="cues"></pres-cue>
      </pres-slide>

      <pres-slide id="presentable">
        <h2>Presenting: <code>Presentable</code>!</h2>
        <pre class="code"><code class="html">
          &lt;pres-show&gt;
            &lt;pres-slide id=&quot;title&quot;&gt;
              &lt;h1&gt;&lt;code&gt;&amp;lt;web-components&amp;gt;&lt;/code&gt;&lt;/h1&gt;
              &lt;pres-cue slot=&quot;cues&quot;&gt;Showtime!&lt;/pres-cue&gt;
            &lt;/pres-slide&gt;
          &lt;/pres-show&gt;
        </code></pre>
        <pres-cue slot="cues">Welcome to my over-engineered, web-components-based, slide framework</pres-cue>
      </pres-slide>

      <pres-slide id="pres-template">
        <h3>Presentable: templates</h3>
        <pre class="code"><code class="js">
          const html = String.raw;
          const template = document.createElement(&#39;template&#39;);
          template.innerHTML = html`
            &lt;style&gt;
              :host {
                bottom: 0;
                contain: content;
                display: block;
                left: 0;
                opacity: 1;
                padding: 1.2vw 2vw;
                position: absolute;
                right: 0;
                top: 0;
                transition: all 400ms cubic-bezier(0.215, 0.61, 0.355, 1);
                visibility: hidden;
              }
              :host([active]) {
                visibility: visible;
              }
              :host(:not([active])) {
                visibility: hidden;
              }
            &lt;/style&gt;
            &lt;slot&gt;&lt;/slot&gt;
            &lt;slot name=&quot;cues&quot;&gt;&lt;/slot&gt;
          `;
        </code></pre>
        <pres-cue slot="cues">presentable-slide.js</pres-cue>
        <pres-cue slot="cues">highlight</pres-cue>
      </pres-slide>

      <pres-slide id="pres-mixin">
        <h3>Presentable: element mixin</h3>
        <pre class="code"><code class="js">
          export function ActiveElementMixin(baseClass) {
            return class ActiveElement extends baseClass {
              get active() {
                return this.getAttribute('active');
              }

              set active(value) {
                if (value) {
                  this.setAttribute('active', '');
                  this.dispatchEvent(
                    new Event('active', { bubbles: true, cancelable: true })
                  );
                } else {
                  this.removeAttribute('active');
                }
              }
            };
          }
        </code></pre>
        <pre class="code"><code class="js">
          handleEvent(event) {
            switch (event.type) {
              case 'active': {
                if (event.target instanceof PresentableCue) {
                  this.elCueNotes.innerHTML = event.target.innerHTML;
                }
                break;
              }
            }
          }
        </code></pre>
        <pres-cue slot="cues">active-element-mixin.js</pres-cue>
        <pres-cue slot="cues">presentable-show.js</pres-cue>
      </pres-slide>
    </pres-show>
  </body>
</html>
